<%- include('partials/header') %>
    <div class="cinema-mode">
        <div class="episodes-sidebar" id="episodesSidebar">
            <div class="sidebar-header">
                <h3>Episodes</h3>
                <span class="total"><%= detail.totalEpisode %> Eps</span>
            </div>
            <div class="episodes-list">
                <% if(detail.shortPlayEpisodeInfos) { %>
                    <% detail.shortPlayEpisodeInfos.forEach(ep => { %>
                        <div class="episode-item" 
                             data-src="<%= ep.playVoucher %>" 
                             data-id="<%= ep.episodeId %>"
                             data-no="<%= ep.episodeNo %>"
                             onclick="playEpisode(this)">
                            <span class="ep-num"><%= ep.episodeNo %></span>
                            <div class="ep-img">
                                <img src="<%= ep.episodeCover %>" loading="lazy">
                                <i class="fas fa-play-circle"></i>
                            </div>
                            <div class="ep-info">
                                <span>Episode <%= ep.episodeNo %></span>
                                <small><%= ep.playClarity %></small>
                            </div>
                        </div>
                    <% }) %>
                <% } %>
            </div>
        </div>

        <div class="video-wrapper" id="videoWrapper">
            <video id="mainPlayer" playsinline>
                Your browser does not support the video tag.
            </video>
            
            <div class="video-overlay" id="videoControls">
                <div class="overlay-top">
                    <a href="/" class="back-btn"><i class="fas fa-arrow-left"></i></a>
                    <div class="playing-title">
                        <h2 id="playerTitle"><%= detail.shortPlayName %></h2>
                        <span id="playerEp">Ep. 1</span>
                    </div>
                </div>

                <div class="center-state">
                    <div class="spinner hidden" id="bufferIcon"></div>
                    <div class="play-state-icon hidden" id="playPauseIcon"><i class="fas fa-play"></i></div>
                </div>

                <div class="controls-bar">
                    <div class="progress-container" id="progressBarContainer">
                        <div class="progress-bg"></div>
                        <div class="progress-fill" id="progressFill"></div>
                        <div class="progress-hover" id="progressHover"></div>
                    </div>
                    
                    <div class="buttons-row">
                        <div class="left-btns">
                            <button id="playBtn"><i class="fas fa-play"></i></button>
                            <button id="rewindBtn"><i class="fas fa-undo-10"></i></button>
                            <button id="forwardBtn"><i class="fas fa-redo-10"></i></button>
                            <div class="volume-container">
                                <button id="muteBtn"><i class="fas fa-volume-up"></i></button>
                                <input type="range" id="volSlider" min="0" max="1" step="0.1" value="1">
                            </div>
                            <span class="time-display">
                                <span id="curTime">00:00</span> / <span id="durTime">00:00</span>
                            </span>
                        </div>
                        <div class="right-btns">
                            <button id="nextEpBtn" class="next-ep-btn">Next Ep <i class="fas fa-step-forward"></i></button>
                            <button id="fullscreenBtn"><i class="fas fa-expand"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const PLAYLIST = <%- JSON.stringify(detail.shortPlayEpisodeInfos || []) %>;
        const SERIES_ID = "<%= detail.shortPlayId %>";
    </script>
<%- include('partials/footer') %>
